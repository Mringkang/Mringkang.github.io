---
title: "Python相关命令"
layout: post
date: 2018-08-21
image: /assets/images/markdown.jpg
headerImage: false
tag:
- Python
category: Python
---


# Python部署最全命令


##  虚拟环境相关

1 升级python包管理工具pip

`pip install --upgrade pip`

备注：当你想升级一个包的时候 `pip install --upgrade 包名`

2 python虚拟环境安装

`sudo apt-get install python-virtualenv`

`sudo easy_install virtualenvwrapper`


上述工具装好后找不到mkvirtualenv命令，需要执行以下环境变量设置。

1.创建目录用来存放虚拟环境

    mkdir $HOME/.virtualenvs
    
2.在~/.bashrc中添加行：

    export WORKON_HOME=$HOME/.virtualenvs
    source /usr/local/bin/virtualenvwrapper.sh
    
4.运行:

    source ~/.bashrc
    
5.创建python虚拟环境

	mkvirtualenv [虚拟环境名称]
	workon [虚拟环境名称]

6.退出虚拟环境 离开 

	deactivate

7.删除(慎用) 

	rmvirtualenv [虚拟环境名称]

$ `source venv/bin/activate`　

$ `.venv/bin/deactivate`


`pip freeze > requirements.txt`


`pip install -r requirements.txt`


## scrapy 相关
创建项目  `scrapy startproject mySpider`

创建文件
`scrapy genspider tencent "tencent.com"`

执行
`scrapy crawl tencent`


通过下面的命令可以快速创建 CrawlSpider模板 的代码：

`scrapy genspider -t crawl tencent tencent.com`


## django 相关

`python manage.py makemigrations`

`python manage.py migrate`

`python manage.py createsuperuser`

`python manage.py runserver 127.0.0.1:8000`

`python manage.py collectstatic` # 注意配置STATIC_ROOT


## 数据库相关

`mysql -uroot -p`

`show databases;`

`use mm;`

`show tables;`

`select user();`

**执行sql文件**

`source /home/kangbing/mm_mmtype.sql`

`source /home/kangbing/mm_mmitem.sql`


## 上传文件相关
从本地往服务器上传文件

	scp mm_mmtype.sql kangbing@xxx:/home/kangbing/mm_mmtype.sql

	scp mm_mmitem.sql kangbing@xxx:/home/kangbing/mm_mmitem.sql
	
文件夹加 -r 即 scp -r

下载到本地调换位置

	scp -r kangbing@xxx:/var/www/mmsite/static/images/ /Users/rrkj/Desktop/images/



## ssh 相关
1. 登录1
cd ~/.ssh 
ssh -i cloudkey kangbing@xx.xx.x.xx

2. 登录2
ssh kangbing@xx.xx.x.xx

## uwsgi相关

* 安装:pip install uwsgi

uwsgi.ini 配置文件

	[uwsgi]
	socket=:8000  # Nginx 
	#http = :8000 # http
	chdir = /home/kangbing/mmsite
	wsgi-file = mmsite/wsgi.py
	module = mmsite.wsgi
	processes = 4
	threads = 2
	master = True
	pidfile = uwsgi.pid
	daemonize = uwsgi.log



* 启动：`uwsgi --ini uwsgi.ini`
* 停止：`uwsgi --stop uwsgi.pid`
* 重启：`uwsgi --reload uwsgi.pid`
* 查看PID: `ps aux | grep uwsgi`
* 测试: `uwsgi --http :8000 --module your_proj_name.wsgi`

## nginx相关

安装`sudo apt-get install nginx`

`sudo service nginx start`

`sudo service nginx stop`

`sudo service nginx status`

配置文件
路径 `/etc/nginx/sites-enabled/default`


	# Default server configuration
	server {
	        listen 80 default_server;
	        listen 35.194.243.78:80 default_server;
	
	        root /var/www/html;
	
	        location / {
	        			# uwsgi
	                include uwsgi_params;
	                # uwsgi.ini 配置的socket
	                uwsgi_pass xx.xx.xx.xx:8000;
	        }
	
				# 静态资源文件目录
				# Django settings.py
				# STATIC_ROOT='/var/www/mmsite/static/'
	        location /static {
	                alias /var/www/mmsite/static/;
	        }
	
	      	}

## 静态文件相关
* 新建文件夹

	`cd /var/www`

	`sudo mkdir mmsite`

* 修改目录权限

	`sudo chmod 777 /var/www/mmsite`
	
* 创建static目录

	`mkdir static`

* 修改settings.py文件

	`STATIC_ROOT='/var/www/mmsite/static/'`
	
* 收集所有静态文件到static_root指定目录

	`python manage.py collectstatic`
	
* 重启nginx、uwsgi


## 压缩
	tar -zcvf a.tar.gz b.txt 

	tar -zxvf a.tar.gz



